

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ca" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ca" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>La consola psql &mdash; Introducció a la programació 1819 documentació</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/moistyle.css" type="text/css" />
    <link rel="author" title="Quant a aquests documents" href="about.html" />
    <link rel="index" title="Índex" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="next" title="PostGreSQL JDBC" href="bd.jdbc.html" />
    <link rel="prev" title="Connectem des de l’amfitrió" href="bd.pgsql.remote.connect.html" />
     
    <script src="_static/moiscripts.js"></script>


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Introducció a la programació
          

          
            
            <img src="_static/logoprg.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1819
              </div>
            
          

          

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="primeres_passes.html">Primeres passes</a></li>
<li class="toctree-l1"><a class="reference internal" href="dades.html">Dades</a></li>
<li class="toctree-l1"><a class="reference internal" href="operadors_i_expressions.html">Operadors i expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="instruccions.html">Instruccions seqüencials</a></li>
<li class="toctree-l1"><a class="reference internal" href="condicionals.html">Condicionals</a></li>
<li class="toctree-l1"><a class="reference internal" href="iteracions.html">Iteracions</a></li>
<li class="toctree-l1"><a class="reference internal" href="strings.html">Strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="programacio_modular.html">Programació Modular</a></li>
<li class="toctree-l1"><a class="reference internal" href="bucles_condicionals.html">Bucles condicionals</a></li>
<li class="toctree-l1"><a class="reference internal" href="sequencies.html">Seqüències</a></li>
<li class="toctree-l1"><a class="reference internal" href="python2java.html">De Python a Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="fitxers.html">Fitxers</a></li>
<li class="toctree-l1"><a class="reference internal" href="estructures.html">Estructures</a></li>
<li class="toctree-l1"><a class="reference internal" href="poo.html">Programació Orientada a Objectes</a></li>
<li class="toctree-l1"><a class="reference internal" href="contenidors.html">Agrupacions d’objectes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="bd.html">Persistència amb bases de dades</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bd.modelrelacional_i_poo.html">La programació orientada a objectes i el model relacional</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="bd.postgresql.html">PostgreSQL</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="bd.vbox.install.html">Instal·lem VirtualBox</a></li>
<li class="toctree-l3"><a class="reference internal" href="bd.vagrant.install.html">Instal·lem Vagrant</a></li>
<li class="toctree-l3"><a class="reference internal" href="bd.vm.crea.html">Creem la màquina virtual</a></li>
<li class="toctree-l3"><a class="reference internal" href="bd.vm.config.html">Configurem la màquina virtual</a></li>
<li class="toctree-l3"><a class="reference internal" href="bd.vm.boot.html">Arrenquem la màquina virtual</a></li>
<li class="toctree-l3"><a class="reference internal" href="bd.vm.connect.html">Connectem a la màquina virtual</a></li>
<li class="toctree-l3"><a class="reference internal" href="bd.pgsql.install.html">Instal·lem PostgreSQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="bd.pgsql.config.html">Configurem PostGreSQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="bd.pgsql.local.html">Connectem localment amb PostGreSQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="bd.pgsql.remote.config.html">Configurem per connexió remota</a></li>
<li class="toctree-l3"><a class="reference internal" href="bd.pgsql.remote.connect.html">Connectem des de l’amfitrió</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">La consola psql</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bd.jdbc.html">PostGreSQL JDBC</a></li>
<li class="toctree-l2"><a class="reference internal" href="bd.consultes.html">JDBC amb Model relacional</a></li>
<li class="toctree-l2"><a class="reference internal" href="bd.agenda.html">L’agenda</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Introducció a la programació</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="bd.html">Persistència amb bases de dades</a> &raquo;</li>
        
          <li><a href="bd.postgresql.html">PostgreSQL</a> &raquo;</li>
        
      <li>La consola psql</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    <div>
    <div id="cookiesbox">
        Aquest lloc web utilitza galetes (<i>cookies</i>) per a analitzar el seu ús
        amb les eines que ofereix <a href="https://www.google.com/analytics">Google Analytics</a>.
        En continuar navegant-hi, estàs acceptant-ho.
        <br/>
        <a class="btn btn-neutral" onclick="setUserAcceptsCookies();">
            Tancar
            <span class="fa fa-window-close"></span>
        </a>
    </div>

    <script>setCookiesboxVisibility();</script>

</div>
    
           <div itemprop="articleBody">
            
  <div class="section" id="la-consola-psql">
<h1>La consola psql<a class="headerlink" href="#la-consola-psql" title="Link permanent a aquest títol">¶</a></h1>
<p>Tal i com ens descriuen a la <a class="reference external" href="https://www.postgresql.org/docs/current/static/app-psql.html">documentació oficial de PostGreSQL</a>, <code class="docutils literal notranslate"><span class="pre">psql</span></code>
és una interfície basada en terminal que ens permet communicar-nos amb el
servidor PostGreSQL de manera interactiva, com a intèrpret de comandes, a
l’hora que ens ofereix diferents utilitats per automatitzar tasques.</p>
<p>Aquesta breu secció ens oferirà un accés ràpid a les funcions més bàsiques
d’aquest entorn operatiu.</p>
<p>Pots venir a mirar aquesta guia cada cop que necessitis fer una consulta
ràpida.</p>
<div class="section" id="per-entrar-i-per-sortir">
<h2>Per entrar i per sortir<a class="headerlink" href="#per-entrar-i-per-sortir" title="Link permanent a aquest títol">¶</a></h2>
<p>Ens connectarem a la base de dades <code class="docutils literal notranslate"><span class="pre">testbd</span></code> que es troba al servidor
<code class="docutils literal notranslate"><span class="pre">192.168.33.10</span></code> amb l’usuari <code class="docutils literal notranslate"><span class="pre">usuaribd</span></code> i password <code class="docutils literal notranslate"><span class="pre">pass</span></code>, escrivint
al terminal :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ psql -U usuaribd -d testbd -h <span class="m">192</span>.168.33.10
</pre></div>
</div>
<p>Per sortir de la consola de <code class="docutils literal notranslate"><span class="pre">psql</span></code>:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="gp">testbd=&gt;</span> <span class="kp">\q</span>
</pre></div>
</div>
</div>
<div class="section" id="per-aconseguir-ajuda">
<h2>Per aconseguir ajuda<a class="headerlink" href="#per-aconseguir-ajuda" title="Link permanent a aquest títol">¶</a></h2>
<p>La consola <code class="docutils literal notranslate"><span class="pre">psql</span></code> disposa d’un sistema d’ajut molt complet.</p>
<p>Obtenim ajuda sobre el programa <code class="docutils literal notranslate"><span class="pre">psql</span></code> amb:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> psql --help
</pre></div>
</div>
<p>Un cop dins de <code class="docutils literal notranslate"><span class="pre">psql</span></code>, podem aconseguir ajuda sobre comandes disponibles amb:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="gp">testbd=&gt;</span> <span class="kp">\?</span>
</pre></div>
</div>
<p>Obtenim ajuda sobre comandes <em>sql</em> amb:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="gp">testbd=&gt;</span> <span class="kp">\h</span>
</pre></div>
</div>
<p>Si volem una comanda concreta, simplement l’afegim a continuació:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="gp">testbd=&gt;</span> <span class="kp">\h</span> <span class="ss">SELECT</span>
</pre></div>
</div>
</div>
<div class="section" id="per-carregar-el-contingut-d-un-fitxer">
<h2>Per carregar el contingut d’un fitxer<a class="headerlink" href="#per-carregar-el-contingut-d-un-fitxer" title="Link permanent a aquest títol">¶</a></h2>
<p>Sovint ens interessarà executar les comandes sql guardades en un fitxer.</p>
<p>Des de terminal:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ psql -U usuaribd -d testbd -h 192.168.33.10 &lt; fitxer.sql
</pre></div>
</div>
<p>o també</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ psql -U usuaribd -d testbd -h 192.168.33.10 -f fitxer.sql
</pre></div>
</div>
<p>Des de consola <code class="docutils literal notranslate"><span class="pre">psql</span></code>:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="gp">testbd=&gt;</span> <span class="kp">\i</span> <span class="ss">fitxer.sql</span>
</pre></div>
</div>
<p><em>Nota</em>: dins del codi, es poden comentar línies amb <code class="docutils literal notranslate"><span class="pre">--</span></code>. Per exemple:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><span class="hll">$ cat quisoc.sql
</span>-- Comprovem quin és l&#39;úsuari amb que ens hem connectat
SELECT current_user;
<span class="hll">$ psql -U usuaribd -d testbd -h 192.168.33.10 -f quisoc.sql
</span>Password for user usuaribd:
 current_user
--------------
 usuaribd
(1 row)
</pre></div>
</div>
</div>
<div class="section" id="per-guardar-el-resultat-d-una-consulta-en-un-fitxer">
<h2>Per guardar el resultat d’una consulta en un fitxer<a class="headerlink" href="#per-guardar-el-resultat-d-una-consulta-en-un-fitxer" title="Link permanent a aquest títol">¶</a></h2>
<p>Una altra necessitat habitual és la de guardar el resultat d’una o més
comandes SQL a un fitxer.</p>
<p>Guardarem la sortida d’una o més comandes, tot indicant des de la consola:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="gp">testbd=&gt;</span> <span class="kp">\o</span> <span class="ss">fitxer.sql</span>
</pre></div>
</div>
<p>Per recuperar la sortida en la consola:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="gp">testbd=&gt;</span> <span class="kp">\o</span>
</pre></div>
</div>
<p>Per descomptat, des de fora de la consola, podem simplement redireccionar
la sortida cap el fitxer que ens interessi.
Per exemple, la següent comanda ens guardarà el resultat d’executar les
comandes del fitxer <code class="docutils literal notranslate"><span class="pre">quisoc.sql</span></code> al fitxer <code class="docutils literal notranslate"><span class="pre">resultat.txt</span></code>.</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="gp">$</span> psql -U usuaribd -d testbd -h <span class="m">192</span>.168.33.10 -f quisoc.sql &gt; resultat.txt
</span><span class="go">Password for user usuaribd:</span>
<span class="hll"><span class="go">$ cat /tmp/resultat.txt</span>
</span><span class="go"> current_user</span>
<span class="go">--------------</span>
<span class="go"> usuaribd</span>
<span class="go">(1 row)</span>
</pre></div>
</div>
</div>
<div class="section" id="consultar-objectes-de-la-base-de-dades">
<h2>Consultar objectes de la base de dades<a class="headerlink" href="#consultar-objectes-de-la-base-de-dades" title="Link permanent a aquest títol">¶</a></h2>
<p>Podem consultar els diferents elements de la base de dades amb les
comandes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>d</td>
<td>mostra tables, seqüències, vistes i indexos</td>
</tr>
<tr class="row-even"><td>dt</td>
<td>mostra les tables</td>
</tr>
<tr class="row-odd"><td>dt clients</td>
<td>mostra els detalls de la taula <em>clients</em></td>
</tr>
<tr class="row-even"><td>dt+ clients</td>
<td>mostra <strong>més</strong> detalls sobre la taula <em>clients</em></td>
</tr>
<tr class="row-odd"><td>dt cl*</td>
<td>mostra els detalls de les taules que comencen amb <em>cl</em></td>
</tr>
<tr class="row-even"><td>d clients</td>
<td>mostra la descripció de la taula <em>clients</em></td>
</tr>
</tbody>
</table>
<p>Per exemple:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="gp">testbd=&gt;</span> <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">exemple</span> <span class="p">(</span><span class="n">clau</span> <span class="nb">INT</span><span class="p">,</span> <span class="n">valor</span> <span class="nb">TEXT</span><span class="p">);</span>
</span><span class="go">CREATE TABLE</span>
<span class="hll"><span class="gp">testbd=&gt;</span> <span class="kp">\d</span>
</span><span class="go">          List of relations</span>
<span class="go"> Schema |  Name   | Type  |  Owner</span>
<span class="go">--------+---------+-------+----------</span>
<span class="go"> public | exemple | table | usuaribd</span>
<span class="go">(1 row)</span>

<span class="hll"><span class="gp">testbd=&gt;</span> <span class="kp">\dt+</span>
</span><span class="go">                       List of relations</span>
<span class="go"> Schema |  Name   | Type  |  Owner   |    Size    | Description</span>
<span class="go">--------+---------+-------+----------+------------+-------------</span>
<span class="go"> public | exemple | table | usuaribd | 8192 bytes |</span>
<span class="go">(1 row)</span>

<span class="hll"><span class="gp">testbd=&gt;</span> <span class="kp">\d</span> <span class="ss">exemple</span>
</span><span class="go">    Table &quot;public.exemple&quot;</span>
<span class="go"> Column |  Type   | Modifiers</span>
<span class="go">--------+---------+-----------</span>
<span class="go"> clau   | integer |</span>
<span class="go"> valor  | text    |</span>

<span class="hll"><span class="gp">testbd=&gt;</span> <span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">exemple</span> <span class="p">;</span>
</span><span class="go">DROP TABLE</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>

          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bd.jdbc.html" class="btn btn-neutral float-right" title="PostGreSQL JDBC" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="bd.pgsql.remote.connect.html" class="btn btn-neutral" title="Connectem des de l’amfitrió" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Copyright 2018-2019 Moisès Gómez Girón.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1819',
            LANGUAGE:'ca',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

     

  <!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-41103782-2', 'auto');
  ga('send', 'pageview');

</script>
  <!-- End Google Analytics -->


  

</body>
</html>