

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ca" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ca" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Constructors &mdash; Introducció a la programació 1819 documentació</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/moistyle.css" type="text/css" />
    <link rel="author" title="Quant a aquests documents" href="about.html" />
    <link rel="index" title="Índex" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="next" title="Membres d’instància i de classe" href="membres_instancia_classe.html" />
    <link rel="prev" title="Classes i objectes" href="classes_i_objectes.html" />
     
    <script src="_static/moiscripts.js"></script>


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Introducció a la programació
          

          
            
            <img src="_static/logoprg.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1819
              </div>
            
          

          

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="primeres_passes.html">Primeres passes</a></li>
<li class="toctree-l1"><a class="reference internal" href="dades.html">Dades</a></li>
<li class="toctree-l1"><a class="reference internal" href="operadors_i_expressions.html">Operadors i expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="instruccions.html">Instruccions seqüencials</a></li>
<li class="toctree-l1"><a class="reference internal" href="condicionals.html">Condicionals</a></li>
<li class="toctree-l1"><a class="reference internal" href="iteracions.html">Iteracions</a></li>
<li class="toctree-l1"><a class="reference internal" href="strings.html">Strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="programacio_modular.html">Programació Modular</a></li>
<li class="toctree-l1"><a class="reference internal" href="bucles_condicionals.html">Bucles condicionals</a></li>
<li class="toctree-l1"><a class="reference internal" href="sequencies.html">Seqüències</a></li>
<li class="toctree-l1"><a class="reference internal" href="python2java.html">De Python a Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="fitxers.html">Fitxers</a></li>
<li class="toctree-l1"><a class="reference internal" href="estructures.html">Estructures</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="poo.html">Programació Orientada a Objectes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="classes_i_objectes.html">Classes i objectes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Constructors</a></li>
<li class="toctree-l2"><a class="reference internal" href="membres_instancia_classe.html">Membres d’instància i de classe</a></li>
<li class="toctree-l2"><a class="reference internal" href="relacions.html">Relacions entre classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="herencia.html">Herència</a></li>
<li class="toctree-l2"><a class="reference internal" href="polimorfisme.html">Polimorfisme</a></li>
<li class="toctree-l2"><a class="reference internal" href="abstractes.html">Classes abstractes</a></li>
<li class="toctree-l2"><a class="reference internal" href="interfaces.html">Interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="poo.eleccio.html">Classes, subclasses, classes abstractes, <em>interfaces</em>?</a></li>
<li class="toctree-l2"><a class="reference internal" href="excepcions.html">Excepcions</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Introducció a la programació</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="poo.html">Programació Orientada a Objectes</a> &raquo;</li>
        
      <li>Constructors</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    <div>
    <div id="cookiesbox">
        Aquest lloc web utilitza galetes (<i>cookies</i>) per a analitzar el seu ús
        amb les eines que ofereix <a href="https://www.google.com/analytics">Google Analytics</a>.
        En continuar navegant-hi, estàs acceptant-ho.
        <br/>
        <a class="btn btn-neutral" onclick="setUserAcceptsCookies();">
            Tancar
            <span class="fa fa-window-close"></span>
        </a>
    </div>

    <script>setCookiesboxVisibility();</script>

</div>
    
           <div itemprop="articleBody">
            
  <div class="section" id="constructors">
<h1>Constructors<a class="headerlink" href="#constructors" title="Link permanent a aquest títol">¶</a></h1>
<p>Coneixerem ara els <em>constructors</em>, un tipus especial de bloc de codi que
en programació orientada a objectes és cridat la creació d’una nova
instància d’una classe, i que té la funció de preparar la instància per a
ser utilitzada.</p>
<p>Aquesta introducció comença amb una secció <em>teòrica</em> que descriu els
constructors (i destructors), per després continuar amb l’anàlisi
d’exercicis en Java.</p>
<div class="admonition warning">
<p class="first admonition-title">Avís</p>
<p class="last">La secció teòrica pot resultar molt complexa per qui mai no ha estat exposat a la gestió
explícita de memòria dinàmica. Si és el teu cas, intenta aproximar-te-hi amb ment oberta.</p>
</div>
<div class="section" id="pero-si-ja-els-coneixem">
<h2>Però si ja els coneixem!<a class="headerlink" href="#pero-si-ja-els-coneixem" title="Link permanent a aquest títol">¶</a></h2>
<p>En realitat ja hem fet servir els constructors. En el tema <a class="reference internal" href="classes_i_objectes.html"><span class="doc">Classes i objectes</span></a> hem vist codi que
fa:</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GatRenat</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">vides</span> <span class="o">=</span> <span class="mi">7</span><span class="o">;</span>                <span class="c1">// vides disponibles del gat Renat</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">GatRenat</span> <span class="n">renat</span><span class="o">;</span>           <span class="c1">// declarem la referència al gat</span>
<span class="hll">        <span class="n">renat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GatRenat</span><span class="o">();</span>   <span class="c1">// creem la instància del gat Renat.</span>
</span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Al gat Renat li queden &quot;</span> <span class="o">+</span> <span class="n">renat</span><span class="o">.</span><span class="na">vides</span> <span class="o">+</span> <span class="s">&quot; vides&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>A la línia 5 estem creant o <em>construint</em> una instància de <em>GatRenat</em>. Un cop executada, sabem que
la referència <em>renat</em> queda inicialitzada a un valor de tipus <em>GatRenat</em>.</p>
<p>D’acord, però… què és el que realment està passant quan cridem al constructor d’una classe?</p>
</div>
<div class="section" id="constructors-i-destructors">
<span id="id1"></span><h2>Constructors i destructors<a class="headerlink" href="#constructors-i-destructors" title="Link permanent a aquest títol">¶</a></h2>
<p>Un aspecte important, pels programes en execució, és la reserva i
posterior alliberament de memòria necessària per a poder fer encabir
dinàmicament les dades que manipulen.</p>
<p>Considerem per exemple, la implementació d’una <em>llista dinàmica</em> d’enllaç simple,
sovint es realitza amb una estructura (Node) que conté almenys dos
camps (el valor a guardar per un element de la llista i un apuntador
al següent node). Normalment ens cal disposar d’un apuntador al primer
node, i el darrer node apunta convenientment a un valor nul.</p>
<p>La següent imatge esquematitza una llista d’aquestes amb dos elements.</p>
<div class="figure align-center">
<img alt="Dos elements" src="_images/poo008.img001.llistadin_doselem.png" />
</div>
<p>En cas que hi vulguem afegir un nou node, ens cal realitzar les
següents passes:</p>
<ol class="arabic simple">
<li><strong>reservar</strong> l’espai pel nou node</li>
<li><strong>inicialitzar</strong> els valors del nou node. Com a mínim l’apuntador a
següent node, que farem apuntar al node que correspongui de la
llista, o bé a <em>null</em> si ha de ser el nou darrer.</li>
<li>reassignar l’apuntador del node de la llista que ha de ser anterior
al nou node, per què tingui com a següent el nou node.</li>
</ol>
<p>El resultat final queda representat per la següent imatge:</p>
<div class="figure align-center">
<img alt="Tres elements" src="_images/poo008.img002.llistadin_treselem.png" />
</div>
<p>Per una altra banda, quan volem eliminar un element de la llista, les
passes que hem de fer són:</p>
<ol class="arabic simple">
<li>fer que el punter a següent node del node anterior al que volem
eliminar, passi a apuntar al node següent del node que volem
eliminar.</li>
<li><strong>alliberar</strong> l’espai ocupat pel node a eliminar.</li>
</ol>
<p>El resultat final queda:</p>
<div class="figure align-center">
<img alt="Menys elements" src="_images/poo008.img003.llistadin_menyselem.png" />
</div>
<p>De les operacions vistes en aquest exemple, podem dir que tot node de
la llista ha de ser:</p>
<ol class="arabic simple">
<li><strong>creat</strong>: <em>reserva de memòria</em> per a allotjar-lo i <em>inicialització</em></li>
<li><strong>destruït</strong>: <em>alliberament</em> de la memòria reservada un cop sabem
que no ens cal tornar a fer-lo servir.</li>
</ol>
<p>En Java, la creació d’una nova instància la realitzem mitjançant
l’expressió <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">«Constructor»(«args»)</span></code> on «Constructor» coincideix
amb el nom de la classe i «args» corresponen als valors
d’inicialització (sovint no hi ha cap).</p>
<p>La destrucció en Java <strong>no</strong> es realitza explícitament (a diferència
d’altres llenguatges OO com ara C++)<a class="footnote-reference" href="#javafinalize" id="id2">[2]</a>.</p>
<p>Java (com molts altres llenguatges OO) disposen d’un procés de baixa
prioritat anomenat <em>recolector d’escombraries</em> (<em>Garbage Collector</em>)
que se n’encarrega d’anar alliberant aquells espais de memòria que ja
no estan referenciats per ningú. El llenguatge no ens ofereix manera
d’influenciar a aquest procés<a class="footnote-reference" href="#javagc" id="id3">[3]</a>.</p>
<p>En tot cas <strong>sí</strong> podem ajudar al <em>Garbage Collector</em>. Si disposem
d’una instància que ocupa <strong>molta</strong> memòria i sabem que ja no la
necessitem més al nostre programa, sempre podem assignar totes les
seves referències a <code class="docutils literal notranslate"><span class="pre">null</span></code>. D’aquesta manera, el <em>Garbage Collector</em>
sabrà de seguida que ja no cal i podrà actuar en conseqüència.
Considera el següent exemple:</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// «…»</span>
<span class="n">ClasseGrossa</span> <span class="n">cg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClasseGrossa</span><span class="o">();</span> <span class="c1">// instància que ocupa molt</span>
<span class="c1">// «…»        // usem la instància tot el que la necessitem</span>
<span class="n">cg</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>      <span class="c1">// eliminem la referència a la instància</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="exercici-1-construccio-del-gat-renat">
<h2>Exercici 1. Construcció del gat Renat<a class="headerlink" href="#exercici-1-construccio-del-gat-renat" title="Link permanent a aquest títol">¶</a></h2>
<p>Considera el següent codi:</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GatRenat</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">vides</span><span class="o">;</span>   <span class="c1">// vides disponibles del gat Renat</span>

    <span class="c1">// constructor per defecte</span>
    <span class="kd">public</span> <span class="nf">GatRenat</span><span class="o">()</span> <span class="o">{</span> <span class="n">vides</span> <span class="o">=</span> <span class="mi">7</span><span class="o">;</span> <span class="o">}</span>

    <span class="c1">// constructor específic</span>
    <span class="kd">public</span> <span class="nf">GatRenat</span><span class="o">(</span><span class="kt">int</span> <span class="n">vides</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">vides</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">vides</span> <span class="o">=</span> <span class="n">vides</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">vides</span> <span class="o">=</span> <span class="mi">7</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getVides</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">vides</span><span class="o">;</span> <span class="o">}</span>

    <span class="c1">// canvia el nombre de vides si el nou valor és vàlid</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setVides</span><span class="o">(</span><span class="kt">int</span> <span class="n">vides</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">vides</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">vides</span> <span class="o">=</span> <span class="n">vides</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">GatRenat</span> <span class="n">renat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GatRenat</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Al Renat li queden &quot;</span> <span class="o">+</span> <span class="n">renat</span><span class="o">.</span><span class="na">getVides</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; vides&quot;</span><span class="o">);</span>
        <span class="n">GatRenat</span> <span class="n">megaRenat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GatRenat</span><span class="o">(</span><span class="mi">12</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;A Mega Renat li queden &quot;</span> <span class="o">+</span> <span class="n">megaRenat</span><span class="o">.</span><span class="na">getVides</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; vides&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>Executa el programa i respon a les següents preguntes:</p>
<ol class="arabic">
<li><p class="first">A quina línia es posa el valor de vides de la instància creada a la 26?</p>
</li>
<li><p class="first">A quina línia es posa el valor de vides de la instància creada a la 28?</p>
</li>
<li><p class="first">Els blocs que s’inicien a les línies 5 i 8 semblen mètodes però hi
ha algunes diferències amb un mètode convencional. Quines són?</p>
</li>
<li><p class="first">Què et suggereixen els comentaris de les línies 4 i 7?</p>
</li>
<li><p class="first">Quan s’executa el codi dels blocs iniciats a les línies 5 i 8.
Ajuda’t, si et cal, de <em>xivatos</em><a class="footnote-reference" href="#xivato" id="id4">[1]</a>.</p>
</li>
<li><p class="first">Elimina o comenta la línia 5. Continua funcionant el codi? Perquè
creus?</p>
</li>
<li><p class="first">Substitueix el codi del bloc de la línia 8 pel següent i descriu
què passa a l’hora d’executar:</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// constructor específic</span>
<span class="kd">public</span> <span class="nf">GatRenat</span><span class="o">(</span><span class="kt">int</span> <span class="n">vides</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">();</span>
    <span class="n">setVides</span><span class="o">(</span><span class="n">vides</span><span class="o">);</span>     <span class="c1">// o també this.setVides(vides);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</li>
<li><p class="first">Per a què creus que serveix el <code class="docutils literal notranslate"><span class="pre">this()</span></code>?</p>
<p>Pista: posa un <em>xivato</em> al constructor per defecte i compara que
passa en executar el codi quan <code class="docutils literal notranslate"><span class="pre">this()</span></code> hi és, i quan el treus.</p>
</li>
</ol>
</div>
<div class="section" id="exercici-2-el-gat-renat-pot-no-neixer-estirat">
<h2>Exercici 2. El gat Renat pot no néixer estirat<a class="headerlink" href="#exercici-2-el-gat-renat-pot-no-neixer-estirat" title="Link permanent a aquest títol">¶</a></h2>
<p>Crea una nova versió de la classe GatRenat a partir de com va quedar a <a class="reference internal" href="classes_i_objectes.html#classes-i-objectes-exercici10"><span class="std std-ref">l’últim exercici</span></a>.</p>
<p>En aquesta ocasió, la classe <code class="docutils literal notranslate"><span class="pre">GatRenat</span></code> permetrà ser inicialitzada tot indicant amb quin estat
(estirat, assegut o dret)
Cal assegurar-se que codi que ja funcionava amb la versió anterior, continuï fent-ho amb aquesta.</p>
<p>Per defecte, el gat Renat <em>naixerà</em> estirat com fins ara, a menys que es faci servir el nou
constructor.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Aquest exercici disposa d’un
<a class="reference download internal" href="_downloads/E002002GatRenatTest.java" download=""><code class="xref download docutils literal notranslate"><span class="pre">test</span> <span class="pre">unitari</span></code></a>.
Assegura’t que el teu codi passa tots els tests.</p>
</div>
</div>
<div class="section" id="exercici-3-lentorn-operatiu-del-gat-renat">
<span id="constructors-i-exercici-entorn-operatiu"></span><h2>Exercici 3. L’entorn operatiu del gat Renat<a class="headerlink" href="#exercici-3-lentorn-operatiu-del-gat-renat" title="Link permanent a aquest títol">¶</a></h2>
<p>En aquesta ocasió desenvoluparem un programa que oferirà la possibilitat d’interaccionar amb el gat
Renat amb una interfície de línia de comandes.</p>
<p>El programa mostrarà com a «prompt» <code class="docutils literal notranslate"><span class="pre">[Renat]:</span></code></p>
<p>Les comandes que se li podran donar seran:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>com estàs?
aixeca’t
seu
estira’t
adéu
</pre></div>
</div>
<p>L’entorn no distingirà entre majúscules i minúscules. En cas que no entengui la comanda, l’entorn
contestarà amb el missatge <code class="docutils literal notranslate"><span class="pre">no</span> <span class="pre">t'entenc</span></code> i continuarà demanant noves comandes.</p>
<p>Inicialment el gat Renat tindrà 7 vides i estarà <strong>dret</strong>.</p>
<p>Quan es demani a l’entorn com està el gat Renat, l’entorn li ho demanarà al gat (fent servir el
mètode <code class="docutils literal notranslate"><span class="pre">GatRenat.getEstatComString()</span></code>) i mostrarà la resposta que retorni el gat amb el misatge
<code class="docutils literal notranslate"><span class="pre">estic</span> <span class="pre">«estat»</span></code>. Per exemple, si el gat respon <code class="docutils literal notranslate"><span class="pre">estirat</span></code>, la resposta de l’entorn serà <code class="docutils literal notranslate"><span class="pre">estic</span>
<span class="pre">estirat</span></code>. El següent diagrama mostra la seqüència d’intercanvis entre els diferents actors
d’aquesta interacció.</p>
<p class="plantuml">
<img src="_images/plantuml-7735e376e7725552c5f434b7d23bce9c8159602c.png" alt="&#64;startuml
    actor usuari
    usuari -&gt; entorn: com estàs?
    entorn -&gt; renat: getEstatComString()
    renat --&gt; entorn: &quot;estirat&quot;
    entorn --&gt; usuari: &quot;estic estirat&quot;

    skinparam sequence {
        ParticipantBackgroundColor white
        ActorBackgroundColor white
    }
&#64;enduml"/>
</p>
<p>Quan se li digui <code class="docutils literal notranslate"><span class="pre">adéu</span></code>, respondrà amb <code class="docutils literal notranslate"><span class="pre">adéu</span></code> i finalitzarà.</p>
<p>Per la resta de comandes, el programa respondrà amb el que respongui el gat.</p>
<p>Per facilitar la prova d’aquest programa, caldrà que respecti algunes condicions addicionals.
Crea una nova classe anomenada <code class="docutils literal notranslate"><span class="pre">EntornOperatiu</span></code> que ofereixi:</p>
<ul>
<li><p class="first">dos constructors. Un constructor per defecte que crearà la seva pròpia instància de <code class="docutils literal notranslate"><span class="pre">GatRenat</span></code> i
un altre d’específic que rebrà la instància de <code class="docutils literal notranslate"><span class="pre">GatRenat</span></code> amb la que treballarà l’entorn.</p>
<p><strong>Atenció</strong>: el constructor <strong>no</strong> farà una còpia de la instància rebuda, sinó que la farà servir
directament. Tot i que, en general, aquesta no és una manera recomanable de programar, en aquesta
situació concreta ens simplifica molt l’exercici.</p>
<p>En ambdós casos, la instància del gat haurà de respectar els requeriments d’inici ja esmentats.</p>
</li>
<li><p class="first">un mètode anomenat <code class="docutils literal notranslate"><span class="pre">String</span> <span class="pre">processaEntrada(String</span> <span class="pre">entrada)</span></code> que rebrà la comanda d’entrada i
retornarà el text que s’haurà de mostrar com a resposta.</p>
</li>
<li><p class="first">un mètode anomenat <code class="docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">demanaSortir(String</span> <span class="pre">entrada)</span></code> que retornarà <code class="docutils literal notranslate"><span class="pre">true</span></code> quan l’entrada
correspongui al text de sortida (en aquest cas <em>adéu</em>.</p>
</li>
</ul>
<p>Crea un mètode <code class="docutils literal notranslate"><span class="pre">main()</span></code> que creï un <code class="docutils literal notranslate"><span class="pre">EntornOperatiu</span></code> i llegeixi comandes de l’entrada estàndard,
les processi amb <code class="docutils literal notranslate"><span class="pre">processaEntrada()</span></code> i mostri el resultat retornat fins que l’usuari demani la
sortida.</p>
<p>Crea un joc de proves que permeti comprovar el funcionament de cadascuna de les opcions. El joc de
proves estarà format per dos fitxers, un amb les comandes d’entrada i un amb la sortida esperada.</p>
<p>El d’entrada començarà amb:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>com estàs?
seu
«…»
</pre></div>
</div>
<p>El de sortida començarà amb:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[Renat] estic dret
[Renat] m&#39;assec
[Renat] «…»
</pre></div>
</div>
<p>Nota: en cas que ens descuidem de finalitzar al fitxer d’entrada amb «adéu», és molt probable que
ens surti un error d’execució del tipus <code class="docutils literal notranslate"><span class="pre">java.lang.NullPointerException</span></code>. El problema és que la
lectura de l’entrada estàndard ens retorna <code class="docutils literal notranslate"><span class="pre">null</span></code> en comptes d’un String buit.  Caldrà només
continuar quan llegim res que no sigui null. És clar, si arribem a null finalitzarem l’execució però
no ens acomiadarem de l’usuari. Faltaria més!</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Aquest exercici disposa d’un
<a class="reference download internal" href="_downloads/E002003EntornOperatiuTest.java" download=""><code class="xref download docutils literal notranslate"><span class="pre">test</span> <span class="pre">unitari</span></code></a>.
Assegura’t que el teu codi passa tots els tests.</p>
</div>
</div>
<div class="section" id="exercici-4-la-classe-hora">
<span id="constructors-i-exercici-classe-hora"></span><h2>Exercici 4. La classe Hora<a class="headerlink" href="#exercici-4-la-classe-hora" title="Link permanent a aquest títol">¶</a></h2>
<p>Implementa la classe Hora amb les propietats (privades) hora, minut i
segon de tipus enter, i els accessors (públics) que assegurin que
l’hora és sempre vàlida.</p>
<p>Per defecte, l’hora correspondrà a <code class="docutils literal notranslate"><span class="pre">0:00:00</span></code>, però la classe oferirà els mecanismes necessaris per
a inicialitzar una hora amb algun altre valor <em>vàlid</em>. És a dir, oferirà un constructor específic
amb la signatura <code class="docutils literal notranslate"><span class="pre">Hora(int</span> <span class="pre">hores,</span> <span class="pre">int</span> <span class="pre">minuts,</span> <span class="pre">int</span> <span class="pre">segons)</span></code> que, en cas de que els valors rebuts no
corresponguin amb una hora vàlida, inicialitzarà l’hora amb el valor per defecte.</p>
<p>Afegeix els següents mètodes:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">incrementa()</span></code>: fa que l’hora tingui un segon més</li>
<li><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">incrementa(int)</span></code>: fa que l’hora s’incrementi en el nombre de segons indicats</li>
<li><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">decrementa()</span></code>: fa que l’hora tingui un segon menys</li>
<li><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">decrementa(int)</span></code>: fa que l’hora es decrementi en el nombre de segons indicats</li>
<li><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">compareTo(Hora)</span></code>: compara amb l’hora indicada i retorna &lt;0 si és menor que la indicada, 0 si són iguals i &gt;0 si és més gran que la indicada.</li>
<li><code class="docutils literal notranslate"><span class="pre">String</span> <span class="pre">toString()</span></code>: retorna un String amb l’hora en format h:mm:ss.</li>
</ul>
<p>Desenvolupa una funció <code class="docutils literal notranslate"><span class="pre">main()</span></code> que demani a l’usuari les dades de
tres hores i, fent servir la classe Hora, les mostri ordenades
creixentment.</p>
<p><strong>Notes / pistes</strong></p>
<ol class="arabic">
<li><p class="first">En cas que un constructor específic es trobi amb un o més
paràmetres no vàlids, inicialitzarà la instància amb els valors per
defecte.</p>
</li>
<li><p class="first">Per escriure el 0 inicial als minuts i segons quan el valor és
menor de 10, es pot fer servir el mètode <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html">System.out.format()</a></p>
<p>Per si vas amb el temps molt just:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;&#39;%d %02d %05d%n&#39;&quot;</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
</pre></div>
</div>
<p>O més compacte:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;&#39;%d %1$02d %1$05d%n&#39;&quot;</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
</pre></div>
</div>
</li>
</ol>
<ul class="simple">
<li>Aquest exercici disposa d’un <a class="reference download internal" href="_downloads/E002004ClasseHoraTest.java" download=""><code class="xref download docutils literal notranslate"><span class="pre">test</span> <span class="pre">unitari</span></code></a>.
Assegura’t que el teu codi passa tots els tests.</li>
</ul>
</div>
<div class="section" id="exercici-5-la-classe-persona">
<h2>Exercici 5. La classe Persona<a class="headerlink" href="#exercici-5-la-classe-persona" title="Link permanent a aquest títol">¶</a></h2>
<p>Implementa la classe Persona amb les propietats nom, cognoms, any de naixement i any de defunció,
protegides amb constructors i accessors que respectin les següents regles:</p>
<ol class="arabic simple">
<li>l’any de naixement haurà de ser sempre un enter positiu més gran o igual a 1 i menor o igual a
l’any actual.</li>
<li>l’any de defunció podrà ser:<ul>
<li>-1 per representar que la persona encara és viva</li>
<li>un valor superior o igual al de l’any de naixement i menor o igual a l’any actual.</li>
</ul>
</li>
<li>el nom i cognoms no podrà ser una cadena buida ni null.</li>
<li>les persones poden ser inicialitzades vives o no.</li>
</ol>
<p>En cas que un constructor rebi un valor no adequat per a alguna de les seves propietats, la
inicialitzarà amb un valor vàlid. En concret,</p>
<ul class="simple">
<li>Per nom i cognoms, el valor serà la cadena «desconegut».</li>
<li>Per l’any de naixement, el valor serà l’any actual.</li>
<li>Per l’any de defunció, el valor serà -1.</li>
</ul>
<p>El valor -1 en la propietat any de defunció, és una decisió d’implementació de la classe que està
subjecta a canvi. Per aquesta raó, hem d’evitar que l’usuari de la classe hagi de fer servir aquest
valor per, per exemple, corregir l’estat d’una persona que s’havia indicat que estava difunta. Per
oferir la possibilitat de marcar una persona com a viva, la classe Persona oferirà el mètode
<code class="docutils literal notranslate"><span class="pre">setViu()</span></code>. Tot plegat no és un disseny massa elegant. Entre d’altres coses ens obliga a assignar
l’any de defunció sempre després de l’any de naixement. Gràcies a que ho mantenim privat, podem
plantejar una millora més endavant sense afecta el codi dels nostres usuaris.</p>
<p>La classe Persona oferirà també el mètode <code class="docutils literal notranslate"><span class="pre">estàViva()</span></code> que indicarà si la persona és o no viva.
També oferirà el mètode <code class="docutils literal notranslate"><span class="pre">getEdat()</span></code> que retornarà l’edat aproximada de la persona, tenint en
comptes l’any actual si està viva o l’any de defunció si no ho és.</p>
<p>El càlcul de l’edat es realitzarà a partir dels anys i serà, per tant, aproximat (no disposem del
mes i el dia).</p>
<p>Per saber l’any actual, podem fer servir el següent codi:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">anyAct</span> <span class="o">=</span> <span class="n">java</span><span class="o">.</span><span class="na">time</span><span class="o">.</span><span class="na">Year</span><span class="o">.</span><span class="na">now</span><span class="o">().</span><span class="na">getValue</span><span class="o">();</span>
</pre></div>
</div>
<p>O si estem amb una versió de Java anterior a 8:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">anyAct</span> <span class="o">=</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Calendar</span><span class="o">.</span><span class="na">YEAR</span><span class="o">);</span>
</pre></div>
</div>
<p>Desenvolupa la classe <code class="docutils literal notranslate"><span class="pre">UsaPersona</span></code> que demani per entrada estàndard les dades d’una persona i si
està viva o no. En cas negatiu, demanarà també l’any de defunció. <em>Atenció</em>: per simplicitat,
<code class="docutils literal notranslate"><span class="pre">UsaPersona</span></code> no comprovarà la validesa de les dades de persona.</p>
<p>Amb aquestes dades construirà una instància de persona i indicarà:</p>
<ul class="simple">
<li>si la persona és difunta: l’edat a la que va arribar</li>
<li>si la persona està encara viva: l’edat actual</li>
</ul>
<p>Considera els següents jocs de prova:</p>
<ul>
<li><p class="first">Prova 1: una persona viva</p>
<p>Fitxer <a class="reference download internal" href="_downloads/test.UsaPersona.01.in" download=""><code class="xref download docutils literal notranslate"><span class="pre">d'entrada</span></code></a></p>
<p>Fitxer <a class="reference download internal" href="_downloads/test.UsaPersona.01.out" download=""><code class="xref download docutils literal notranslate"><span class="pre">de</span> <span class="pre">sortida</span></code></a></p>
</li>
<li><p class="first">Prova 2: una persona difunta</p>
<p>Fitxer <a class="reference download internal" href="_downloads/test.UsaPersona.02.in" download=""><code class="xref download docutils literal notranslate"><span class="pre">d'entrada</span></code></a></p>
<p>Fitxer <a class="reference download internal" href="_downloads/test.UsaPersona.02.out" download=""><code class="xref download docutils literal notranslate"><span class="pre">de</span> <span class="pre">sortida</span></code></a></p>
</li>
</ul>
<p>Modifica els fitxers de sortida de manera que les dates corresponguin a l’any en que estàs
realitzant aquest exercici. A continuació fes que el teu programa passi totes dues proves.</p>
<div class="admonition tip">
<p class="first admonition-title">Pista</p>
<p>Per fer servir aquests jocs de prova, pots usar l’eina <em>diff</em> de GNU. Per exemple:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ java UsaPersona &lt; test.UsaPersona.01.in <span class="p">|</span> diff test.UsaPersona.01.out -
</pre></div>
</div>
<p class="last">Si l’anterior no et dóna cap missatge, és que coincideixen el que generes i el que s’espera.</p>
</div>
<p class="rubric">Notes</p>
<table class="docutils footnote" frame="void" id="xivato" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[1]</a></td><td><p class="first">Un <em>xivato</em> és un missatge, normalment escrit per sortida
estàndard, que permet saber que s’ha passat per alguna línia de codi.</p>
<p>Es tracta d’una pràctica senzilla i eficaç per realitzar proves de
codi quan no es disposa d’un depurador (o no es pot/vol fer
servir).</p>
<p>Solen ser molt més efectius quan incorporen certa informació de
context. Per exemple, trobar-se:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>per aquí 1
per aquí 2
</pre></div>
</div>
<p>és molt menys informatiu vistós que un:</p>
<div class="last highlight-none notranslate"><div class="highlight"><pre><span></span>XXX GatRenat.setVides(-12): entra amb vides inicials 7
XXX GatRenat.setVides(-12): surt amb vides finals 7
</pre></div>
</div>
</td></tr>
</tbody>
</table>
</div>
<div class="section" id="exercici-6-que-he-apres-dels-constructors">
<h2>Exercici 6. Què he aprés dels constructors?<a class="headerlink" href="#exercici-6-que-he-apres-dels-constructors" title="Link permanent a aquest títol">¶</a></h2>
<p>Fes un repàs dels continguts d’aquest tema incloent els exercicis anteriors.
Indica exercici a exercici què has aprés de nou en fer-lo, o bé quins són els
conceptes que introdueix l’exercici, si ja els coneixies anteriorment. Procura
ser molt concret. Si et cal, ajuda’t de (nous) exemples.</p>
<p>En el cas que no hagis entès algun dels exercicis… bé, aquest cas no es pot
donar ja que, abans de fer aquest exercici t’ajudaràs de les diferents fonts de
suport que tens al teu abast (incloent, és clar, consultes al teu docent) per
arribar a entendre’l. És a dir, <strong>no val</strong> dir, que un exercici no l’has entès!
Entesos?</p>
<p>Redacta aquest exercici en un document de text pla. Et recomano que facis servir
algun format de text de marques com ara <a class="reference internal" href="rst.intro.html"><span class="doc">reStructuredText</span></a>
o <a class="reference external" href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet">markdown</a>.</p>
<hr class="docutils" />
<table class="docutils footnote" frame="void" id="javafinalize" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>Si bé els objectes Java disposen del
mètode <code class="docutils literal notranslate"><span class="pre">finalize()</span></code>, es tracta d’un mètode per especificar accions
de neteja i no per decidir quan una instància ha de ser alliberada.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="javagc" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td>De fet si que podem fer una crida a
<code class="docutils literal notranslate"><span class="pre">Runtime.getRuntime().gc()</span></code> o <code class="docutils literal notranslate"><span class="pre">System.gc()</span></code> què, com diu
l’especificació del mètode, <em>suggereix</em> a la màquina virtual de
Java a dedicar esforços per recuperar la memòria disponible, tot i
que serà cridat de manera automàtica cada cop que la màquina
virtual ho trobi necessari.</td></tr>
</tbody>
</table>
<hr class="docutils" />
<p><em>Ref. 20.1.2</em></p>
</div>
</div>


           </div>
           
          </div>

          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="membres_instancia_classe.html" class="btn btn-neutral float-right" title="Membres d’instància i de classe" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="classes_i_objectes.html" class="btn btn-neutral" title="Classes i objectes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Copyright 2018-2019 Moisès Gómez Girón.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1819',
            LANGUAGE:'ca',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

     

  <!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-41103782-2', 'auto');
  ga('send', 'pageview');

</script>
  <!-- End Google Analytics -->


  

</body>
</html>