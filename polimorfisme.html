

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ca" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ca" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Polimorfisme &mdash; Introducció a la programació 1819 documentació</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/moistyle.css" type="text/css" />
    <link rel="author" title="Quant a aquests documents" href="about.html" />
    <link rel="index" title="Índex" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="next" title="Classes abstractes" href="abstractes.html" />
    <link rel="prev" title="Casos especials" href="herencia.casos_especials.html" />
     
    <script src="_static/moiscripts.js"></script>


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Introducció a la programació
          

          
            
            <img src="_static/logoprg.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1819
              </div>
            
          

          

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="primeres_passes.html">Primeres passes</a></li>
<li class="toctree-l1"><a class="reference internal" href="dades.html">Dades</a></li>
<li class="toctree-l1"><a class="reference internal" href="operadors_i_expressions.html">Operadors i expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="instruccions.html">Instruccions seqüencials</a></li>
<li class="toctree-l1"><a class="reference internal" href="condicionals.html">Condicionals</a></li>
<li class="toctree-l1"><a class="reference internal" href="iteracions.html">Iteracions</a></li>
<li class="toctree-l1"><a class="reference internal" href="strings.html">Strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="programacio_modular.html">Programació Modular</a></li>
<li class="toctree-l1"><a class="reference internal" href="bucles_condicionals.html">Bucles condicionals</a></li>
<li class="toctree-l1"><a class="reference internal" href="sequencies.html">Seqüències</a></li>
<li class="toctree-l1"><a class="reference internal" href="python2java.html">De Python a Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="fitxers.html">Fitxers</a></li>
<li class="toctree-l1"><a class="reference internal" href="estructures.html">Estructures</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="poo.html">Programació Orientada a Objectes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="classes_i_objectes.html">Classes i objectes</a></li>
<li class="toctree-l2"><a class="reference internal" href="constructors_i.html">Constructors</a></li>
<li class="toctree-l2"><a class="reference internal" href="membres_instancia_classe.html">Membres d’instància i de classe</a></li>
<li class="toctree-l2"><a class="reference internal" href="relacions.html">Relacions entre classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="herencia.html">Herència</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Polimorfisme</a></li>
<li class="toctree-l2"><a class="reference internal" href="abstractes.html">Classes abstractes</a></li>
<li class="toctree-l2"><a class="reference internal" href="interfaces.html">Interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="poo.eleccio.html">Classes, subclasses, classes abstractes, <em>interfaces</em>?</a></li>
<li class="toctree-l2"><a class="reference internal" href="excepcions.html">Excepcions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contenidors.html">Agrupacions d’objectes</a></li>
<li class="toctree-l1"><a class="reference internal" href="bd.html">Persistència amb bases de dades</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Introducció a la programació</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="poo.html">Programació Orientada a Objectes</a> &raquo;</li>
        
      <li>Polimorfisme</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    <div>
    <div id="cookiesbox">
        Aquest lloc web utilitza galetes (<i>cookies</i>) per a analitzar el seu ús
        amb les eines que ofereix <a href="https://www.google.com/analytics">Google Analytics</a>.
        En continuar navegant-hi, estàs acceptant-ho.
        <br/>
        <a class="btn btn-neutral" onclick="setUserAcceptsCookies();">
            Tancar
            <span class="fa fa-window-close"></span>
        </a>
    </div>

    <script>setCookiesboxVisibility();</script>

</div>
    
           <div itemprop="articleBody">
            
  <div class="section" id="polimorfisme">
<h1>Polimorfisme<a class="headerlink" href="#polimorfisme" title="Link permanent a aquest títol">¶</a></h1>
<p>Aquest document introdueix al concepte de <em>polimorfisme</em>. En una de les seves versions, el
polimorfisme esdevé una de les conseqüències més útils de l’herència i altres relacions
jeràrquiques.</p>
<div class="section" id="definicio">
<h2>Definició<a class="headerlink" href="#definicio" title="Link permanent a aquest títol">¶</a></h2>
<p>Una possible definició del polimorfisme és: possibilitat que ofereixen alguns llenguatges
de programació de fer servir dades de diferents tipus d’una manera uniforme.</p>
<p>De les diferents «varietats» de polimorfisme que els teòrics discuteixen, en aquest
context ens és útil considerar:</p>
<ol class="arabic">
<li><p class="first"><em>polimorfisme de funcions</em> o <em>polimorfisme estàtic</em>: mètodes que poden ser aplicats a diferents
tipus d’arguments. És el que aconseguim, per exemple, amb la sobrecàrrega de mètodes en Java. Ex.</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">A</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">m</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">)</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>     <span class="c1">// versió amb enter</span>
    <span class="kt">void</span> <span class="nf">m</span><span class="o">(</span><span class="kt">char</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>    <span class="c1">// versió amb caràcter</span>
    <span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">m</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>       <span class="c1">// usa la versió amb enter</span>
        <span class="n">m</span><span class="o">(</span><span class="sc">&#39;1&#39;</span><span class="o">);</span>     <span class="c1">// usa la versió amb caràcter</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</li>
<li><p class="first"><em>polimòrfisme de subclasses</em> o <em>polimorfisme dinàmic</em>: una variable declarada d’una determinada
classe A, pot fer referència a instàncies de la classe A, però també de qualsevol classe B que
tingui a A com a avantpassat<a class="footnote-reference" href="#avantpassat" id="id1">[1]</a>. Ex.</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">A</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
<span class="kd">class</span> <span class="nc">B</span> <span class="kd">extends</span> <span class="n">A</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
<span class="kd">class</span> <span class="nc">C</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">A</span> <span class="n">a</span><span class="o">;</span>            <span class="c1">// referència de tipus A</span>
        <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">A</span><span class="o">();</span>    <span class="c1">// instància de tipus A</span>
        <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">B</span><span class="o">();</span>    <span class="c1">// instància de tipus B assignada a una referència de tipus A</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</li>
</ol>
</div>
<div class="section" id="b-es-un-a-pero-a-no-es-un-b">
<h2>B és un A però A no és un B<a class="headerlink" href="#b-es-un-a-pero-a-no-es-un-b" title="Link permanent a aquest títol">¶</a></h2>
<p>EL polimorfisme de subclasses ens permet fer servir una variable de
la superclasse per referenciar una instància de la subclasse, però
<strong>no</strong> a l’inrevés.</p>
<p>El següent dibuix intenta mostrar-ho gràficament.</p>
<div class="figure align-center">
<img alt="Metàfora dels cucurutxos" src="_images/cucurutxos.png" />
</div>
<p>A la imatge veiem com un suport (<em>variable</em>) per cucurutxos de tipus
(<em>classe</em>) A, pot subjectar (<em>referenciar</em>) cucurutxos (<em>instàncies</em>) de
tipus A. Aquest mateix suport, és capaç de subjectar cucurutxos que
estenen el tipus A. En canvi, amb el suport pels cucurutxos de tipus
B, els de tipus A ens <strong>caurien</strong> a terra!</p>
</div>
<div class="section" id="assignacio-tardana">
<h2>Assignació tardana<a class="headerlink" href="#assignacio-tardana" title="Link permanent a aquest títol">¶</a></h2>
<p><em>Assignació tardana</em> (o <em>late binding</em>) és la determinació del tipus de
dades/mètode que realment s’executarà és realitza en temps d’execució i no en la
compilació.</p>
<p>Per exemple, considerem:</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="kd">class</span> <span class="nc">A</span> <span class="o">{</span>
     <span class="kt">void</span> <span class="nf">m</span><span class="o">()</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
 <span class="o">}</span>
 <span class="kd">class</span> <span class="nc">C</span> <span class="o">{</span>
     <span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="o">{</span>
         <span class="n">A</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">A</span><span class="o">();</span>
         <span class="n">a</span><span class="o">.</span><span class="na">m</span><span class="o">();</span>
     <span class="o">}</span>
 <span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>El codi que finalment es cridarà en la línia 7 sembla que podria ser
determinat en temps de compilació: no hauria de ser el definit pel
mètode <code class="docutils literal notranslate"><span class="pre">A.m()</span></code>?. En canvi:</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="kd">class</span> <span class="nc">A</span> <span class="o">{</span>
     <span class="kt">void</span> <span class="nf">m</span><span class="o">()</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
 <span class="o">}</span>
 <span class="kd">class</span> <span class="nc">B</span> <span class="kd">extends</span> <span class="n">A</span> <span class="o">{</span>
     <span class="kt">void</span> <span class="nf">m</span><span class="o">()</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span> <span class="c1">// redefinició de m()</span>
     <span class="kt">void</span> <span class="nf">n</span><span class="o">()</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span> <span class="c1">// un altre mètode</span>
 <span class="o">}</span>
 <span class="kd">class</span> <span class="nc">C</span> <span class="o">{</span>
     <span class="kt">void</span> <span class="nf">f</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">)</span> <span class="o">{</span>
         <span class="n">a</span><span class="o">.</span><span class="na">m</span><span class="o">();</span>
         <span class="k">if</span> <span class="o">(</span><span class="n">a</span> <span class="k">instanceof</span> <span class="n">B</span><span class="o">)</span> <span class="o">{</span>   <span class="c1">// comprova si a és instància de B</span>
             <span class="n">B</span> <span class="n">b</span> <span class="o">=</span> <span class="o">(</span><span class="n">B</span><span class="o">)</span><span class="n">a</span><span class="o">;</span>         <span class="c1">// considera a com un B</span>
             <span class="n">b</span><span class="o">.</span><span class="na">n</span><span class="o">();</span>              <span class="c1">// ara ja puc accedir a B.n()</span>
             <span class="o">((</span><span class="n">B</span><span class="o">)</span><span class="n">a</span><span class="o">).</span><span class="na">n</span><span class="o">();</span>         <span class="c1">// també ho puc fer directament</span>
         <span class="o">}</span>
     <span class="o">}</span>
     <span class="kt">void</span> <span class="nf">g</span><span class="o">()</span> <span class="o">{</span>
         <span class="n">f</span><span class="o">(</span><span class="k">new</span> <span class="n">A</span><span class="o">());</span>
         <span class="n">f</span><span class="o">(</span><span class="k">new</span> <span class="n">B</span><span class="o">());</span>
     <span class="o">}</span>
 <span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>En aquest segon exemple, la situació no està tan clara. Quin mètode
s’executarà a la línia 10? El del mètode definit a la línia 2 o el de
la 5?</p>
<p>El compilador no té manera de saber-ho, així que serà la màquina
virtual qui ho determinarà, en funció del tipus de la instància que
finalment estigui rebent <code class="docutils literal notranslate"><span class="pre">C.f(A)</span></code>.</p>
<p>A la línia 11 fem servir l’operador <code class="docutils literal notranslate"><span class="pre">instanceof</span></code>. Aquest operador ens
retornarà True si, en temps d’execució, el primer operand resulta ser
una instància del tipus del segon operand (o bé d’una subclasse
d’aquest)<a class="footnote-reference" href="#instanceof" id="id2">[3]</a>.</p>
<p>Sovint <em>late binding</em> es traduït també per <em>assignació dinàmica</em>, per
contrapossar-ho a l”<em>assignació estàtica</em> que oferiria el compilador
(si pogués).</p>
<p>Per cert, aquesta flexibilitat té un preu: es paga amb la velocitat
d’execució. Si estàs desenvolupant un codi on l’eficiència sigui
crítica i saps que un mètode no serà redefinit per una subclasse, pots
facilitar la feina al compilador fent servir <code class="docutils literal notranslate"><span class="pre">final</span></code>:</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="kd">class</span> <span class="nc">A</span> <span class="o">{</span>
     <span class="kd">final</span> <span class="kt">void</span> <span class="nf">m</span><span class="o">()</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
 <span class="o">}</span>
 <span class="kd">class</span> <span class="nc">C</span> <span class="o">{</span>
     <span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="o">{</span>
         <span class="n">A</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">A</span><span class="o">();</span>
         <span class="n">a</span><span class="o">.</span><span class="na">m</span><span class="o">();</span>
     <span class="o">}</span>
 <span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>Amb aquest darrer exemple, el compilador <em>sí</em> sap quin serà el codi
que s’executarà. Això sí, no intentis crear una subclasse B com la de
fa dos exemples perquè el compilador es queixarà!</p>
</div>
<div class="section" id="si-pero-quin-metode-es-crida">
<h2>Sí però… quin mètode es crida<a class="headerlink" href="#si-pero-quin-metode-es-crida" title="Link permanent a aquest títol">¶</a></h2>
<p>Quan ens enfrontem per primer cop al polimorfisme, una de les
dificultats més grans és saber com es realitza finalment aquesta
assignació tardana.</p>
<p>Per exemple:</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="kd">class</span> <span class="nc">A</span> <span class="o">{</span>
     <span class="kt">void</span> <span class="nf">m</span><span class="o">()</span> <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;superclasse&quot;</span><span class="o">);</span> <span class="o">}</span>
 <span class="o">}</span>

 <span class="kd">class</span> <span class="nc">B</span> <span class="kd">extends</span> <span class="n">A</span> <span class="o">{</span>
     <span class="kt">void</span> <span class="nf">m</span><span class="o">()</span>  <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;subclasse&quot;</span><span class="o">);</span> <span class="o">}</span>
     <span class="kt">void</span> <span class="nf">sm</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">.</span><span class="na">m</span><span class="o">();</span> <span class="o">}</span> <span class="c1">// una mena d&#39;àlies de A.m()</span>
 <span class="o">}</span>

 <span class="kd">class</span> <span class="nc">C</span> <span class="o">{</span>
     <span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="o">{</span>
         <span class="n">A</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">A</span><span class="o">();</span>
         <span class="n">a</span><span class="o">.</span><span class="na">m</span><span class="o">();</span>       <span class="c1">// escriu: superclasse</span>
         <span class="n">B</span> <span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="n">B</span><span class="o">();</span>
         <span class="n">b</span><span class="o">.</span><span class="na">m</span><span class="o">();</span>       <span class="c1">// escriu: subclasse</span>
         <span class="o">((</span><span class="n">A</span><span class="o">)</span><span class="n">b</span><span class="o">).</span><span class="na">m</span><span class="o">();</span>  <span class="c1">// escriu... subclasse!</span>
         <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">B</span><span class="o">();</span>
         <span class="n">a</span><span class="o">.</span><span class="na">m</span><span class="o">();</span>       <span class="c1">// escriu... subclasse!</span>
         <span class="n">b</span><span class="o">.</span><span class="na">sm</span><span class="o">();</span>      <span class="c1">// escriu: superclasse</span>

         <span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="n">A</span><span class="o">();</span> <span class="c1">// error de compilació</span>
         <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">A</span><span class="o">();</span>
         <span class="n">a</span><span class="o">.</span><span class="na">sm</span><span class="o">();</span>      <span class="c1">// error de compilació</span>
         <span class="o">((</span><span class="n">B</span><span class="o">)</span><span class="n">a</span><span class="o">).</span><span class="na">sm</span><span class="o">();</span> <span class="c1">// error d&#39;execució</span>
     <span class="o">}</span>
 <span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>En l’exemple veiem que a la màquina virtual no hi ha manera de fer-li
executar el mètode definit per A des d’una instància de B (excepte
fent servir l”»<em>àlies</em>» <code class="docutils literal notranslate"><span class="pre">B.sm()</span></code>.</p>
<p>L’exemple afegeix, a mode de repàs, alguns errors típics dels que
s’inicien amb aquests temes.</p>
</div>
<div class="section" id="liskov">
<h2>Liskov<a class="headerlink" href="#liskov" title="Link permanent a aquest títol">¶</a></h2>
<p>El principi de substitució de <a class="reference external" href="http://en.wikipedia.org/wiki/Barbara_Jane_Liskov">Liskov</a> diu que:</p>
<blockquote>
<div>una herència entre dues classes està correctament definida si
<strong>sempre</strong> es pot fer servir una instància de la subclasse allà on
el programa espera una instància de la superclasse.</div></blockquote>
<p>Un exemple típic d’herència incorrecta<a class="footnote-reference" href="#herenciaincorrecta" id="id4">[2]</a> és entre
Quadrat i Rectangle (o també Cercle i Oval). Suposa que tens les
següents classes:</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="kd">class</span> <span class="nc">Rectangle</span> <span class="o">{</span>
     <span class="kd">private</span> <span class="kt">int</span> <span class="n">base</span><span class="o">,</span> <span class="n">altura</span><span class="o">;</span>
     <span class="kd">public</span> <span class="nf">Rectangle</span><span class="o">(</span><span class="kt">int</span> <span class="n">base</span><span class="o">,</span> <span class="kt">int</span> <span class="n">altura</span><span class="o">)</span> <span class="o">{</span>
         <span class="k">this</span><span class="o">.</span><span class="na">base</span> <span class="o">=</span> <span class="n">base</span><span class="o">;</span> <span class="k">this</span><span class="o">.</span><span class="na">altura</span> <span class="o">=</span> <span class="n">altura</span><span class="o">;</span>
     <span class="o">}</span>
     <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getBase</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">base</span><span class="o">;</span> <span class="o">}</span>
     <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getAltura</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">altura</span><span class="o">;</span> <span class="o">}</span>
     <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setBase</span><span class="o">(</span><span class="kt">int</span> <span class="n">base</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">base</span><span class="o">=</span><span class="n">base</span><span class="o">;</span> <span class="o">}</span>
     <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAltura</span><span class="o">(</span><span class="kt">int</span> <span class="n">altura</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">altura</span><span class="o">=</span><span class="n">altura</span><span class="o">;</span> <span class="o">}</span>
     <span class="cm">/* ... */</span>
 <span class="o">}</span>

 <span class="kd">class</span> <span class="nc">Quadrat</span> <span class="kd">extends</span> <span class="n">Rectangle</span> <span class="o">{</span>
     <span class="kd">public</span> <span class="nf">Quadrat</span><span class="o">(</span><span class="kt">int</span> <span class="n">costat</span><span class="o">)</span> <span class="o">{</span>
         <span class="kd">super</span><span class="o">(</span><span class="n">costat</span><span class="o">,</span> <span class="n">costat</span><span class="o">);</span>
     <span class="o">}</span>
     <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getCostat</span><span class="o">()</span> <span class="o">{</span> <span class="n">getBase</span><span class="o">();</span> <span class="o">}</span>
     <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setCostat</span><span class="o">(</span><span class="kt">int</span> <span class="n">costat</span><span class="o">)</span> <span class="o">{</span>
         <span class="n">setBase</span><span class="o">(</span><span class="n">costat</span><span class="o">);</span>
         <span class="n">setAltura</span><span class="o">(</span><span class="n">costat</span><span class="o">);</span>
     <span class="o">}</span>
     <span class="cm">/* ... */</span>
 <span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>Malgrat que, en principi, una herència com aquesta pot semblar una
bona idea (especialment si els «…» inclouen molt de codi, en
realitat amaga una desagradable sorpresa. Considera el següent codi:</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="kd">class</span> <span class="nc">UsaRectangles</span> <span class="o">{</span>
     <span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="o">{</span>
         <span class="n">Rectangle</span><span class="o">[]</span> <span class="n">rectangles</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
         <span class="n">rectangles</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">);</span>
         <span class="n">rectangles</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Quadrat</span><span class="o">(</span><span class="mi">4</span><span class="o">);</span>
         <span class="k">for</span> <span class="o">(</span><span class="n">Rectangle</span> <span class="n">r</span><span class="o">:</span> <span class="n">rectangles</span><span class="o">)</span> <span class="o">{</span>
             <span class="n">r</span><span class="o">.</span><span class="na">setBase</span><span class="o">(</span><span class="n">r</span><span class="o">.</span><span class="na">getBase</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span> <span class="c1">// encongeix la base</span>
         <span class="o">}</span>
     <span class="o">}</span>
 <span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>En <code class="docutils literal notranslate"><span class="pre">UsaRectangles.f()</span></code> aconseguim que la instància de Quadrat
referenciada per <code class="docutils literal notranslate"><span class="pre">rectangles[1]</span></code> acabi tenint un quadrat de costat 3
i 4!. És a dir, hem aconseguit <em>petar</em> la coherència de la classe i
tot fent-la servir «legalment».</p>
<p>El problema de l’exemple és que un quadrat <strong>no</strong> es pot considerar un
rectangle en tots els contexts on s’espera que es comporti
correctament un rectangle (ex. quan encongim un dels seus costats)</p>
<p>En resum, abans de crear una subclasse B d’una classe A, assegurem-nos
que podem dir que tot B <strong>és un</strong> A. No n’hi ha prou amb que <em>algun</em> B
és un A, o tot B s”<em>assembla</em> a A, o <em>és pràcticament un</em> A <em>excepte
per</em>…, etc. Els <em>ornitorincs</em> en POO a la llarga es paguen cars. No
diguis després que no se t’ha avisa’t!.</p>
</div>
<div class="section" id="exercici-1-el-meu-exemple-d-herencia-revisitat">
<h2>Exercici 1. El meu exemple d’herència (revisitat)<a class="headerlink" href="#exercici-1-el-meu-exemple-d-herencia-revisitat" title="Link permanent a aquest títol">¶</a></h2>
<p>Recupera l’exemple d’herència que vas definir a <a class="reference internal" href="herencia.intro.html#exercici-el-meu-exemple-dherencia"><span class="std std-ref">Exercici 1. El meu exemple d’herència</span></a>.</p>
<p>Descriu perquè el teu exemple respecta o no el principi de Liskov.</p>
</div>
<div class="section" id="exercici-2-veiem-quin-metode-es-crida">
<h2>Exercici 2. Veiem quin mètode es crida<a class="headerlink" href="#exercici-2-veiem-quin-metode-es-crida" title="Link permanent a aquest títol">¶</a></h2>
<p>La secció <a class="reference internal" href="#si-pero-quin-metode-es-crida">Sí però… quin mètode es crida</a> presenta un codi orientat a
demostrar l’assignació tardana en Java. Els noms de les classes i els mètodes
poden resultar massa abstractes.</p>
<p>Reemplaça’ls per unes classes i mètodes amb més sentit per a tu. Podrien ser
relacionades amb les que has definit a l’exercici anterior.</p>
<p>El programa resultant hauria de comportar-se de la mateixa manera que
l’original.</p>
<p class="rubric">Anotacions</p>
<table class="docutils footnote" frame="void" id="avantpassat" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>(B és subclasse de A, o bé d’una classe C que tingui a A com a
avantpassat)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="herenciaincorrecta" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[2]</a></td><td>Sorprenentment, aquestes exemples els
trobarem a molts textos (i cursos) d’introducció a la programació
orientada a objectes, pel concepte d’herència!</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="instanceof" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[3]</a></td><td>No tothom està gaire d’acord amb l’ús «indiscriminat»
del <em>instanceof</em>. Mira per exemple l’article <a class="reference external" href="http://www.javapractices.com/topic/TopicAction.do?Id=31">Beware of instanceof
operator</a></td></tr>
</tbody>
</table>
<hr class="docutils" />
<p><em>Ref. 20.1.6</em></p>
</div>
</div>


           </div>
           
          </div>

          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="abstractes.html" class="btn btn-neutral float-right" title="Classes abstractes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="herencia.casos_especials.html" class="btn btn-neutral" title="Casos especials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Copyright 2018-2019 Moisès Gómez Girón.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1819',
            LANGUAGE:'ca',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

     

  <!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-41103782-2', 'auto');
  ga('send', 'pageview');

</script>
  <!-- End Google Analytics -->


  

</body>
</html>