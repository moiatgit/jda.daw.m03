#####################
Configurem PostGreSQL
#####################

En instal·lar *PostGreSQL*, ens ha creat usuari *postgres* i la base de dades *template*.

Ens connectarem al servidor de *PostGreSQL* mitjançant l'aplicació ``psql`` des del seu
usuari administrador (*postgres*). Primer ens *convertirem* en *postgres* amb la següent
comanda:

.. code-block:: none
    :emphasize-lines: 1

    vagrant@stretch:~$ sudo su - postgres
    postgres@stretch:~$

Fixa't que ha canviat el *prompt* a ``postgres@stretch:~$``.

Connectem-nos al servidor fent servir ``psql``:

.. code-block:: none
    :emphasize-lines: 1

        postgres@stretch:~$ psql
        psql (11.2 (Debian 11.2-1.pgdg90+1))
        Type "help" for help.

        postgres=#

Ara toca crear-hi un usuari i una base de dades on fer proves. L'usuari
serà **usuaribd** amb password **pass** i la base de dades es dirà
**testbd**.

.. code-block:: none
    :emphasize-lines: 1, 3, 5

        postgres=# CREATE USER usuaribd WITH PASSWORD 'pass';
        CREATE ROLE
        postgres=# CREATE DATABASE testbd;
        CREATE DATABASE
        postgres=# GRANT ALL PRIVILEGES ON DATABASE testbd TO usuaribd;
        GRANT

.. note:: De debó ``pass`` com a password?

    Per descomptat, en un sistema de producció faríem servir un password
    més fort. Si has seguit les passes d'aquesta guia, la màquina virtual
    només es accessible des del nostre amfitrió, i per tant, aquest
    password és raonablement segur per fer proves.

Comprovem que hem creat l'usuari, la base de dades que els hem vinculat:

.. code-block:: none
    :emphasize-lines: 1, 7

    postgres=# \du usuaribd
               List of roles
     Role name | Attributes | Member of
    -----------+------------+-----------
     usuaribd  |            | {}

    postgres=# \l testbd
                                    List of databases
      Name  |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges   
    --------+----------+----------+-------------+-------------+-----------------------
     testbd | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =Tc/postgres         +
            |          |          |             |             | postgres=CTc/postgres+
            |          |          |             |             | usuaribd=CTc/postgres
    (1 row)

Finalment sortim de l'intèrpret ``psql`` i de la sessió de *postgres*:

.. code-block:: none
    :emphasize-lines: 1

    postgres=# \q
    postgres@stretch:~$ exit
    logout
    vagrant@stretch:~$

.. note:: És possible que el primer cop que sortim de *psql* ens generi un
    missatge com ara:

    .. code-block:: none

        could not save history to file
        "/var/lib/postgresql/.psql_history": No such file or directory

    Si és així, el podem ignorar amb tranquil·litat.

